## General 
This repository contains scripts for performing the enrichment analysis, including constructing a background of CpGs matched to Sentinel CpGs by methylation levels and variablity, as well as determining significant enrichment or depletion of sentinel CpGs for gene regulatory features. While the provided scripts analyse sentinel CpG enrichment in Roadmap learned chromatin states, DHS and 5 core histone marks, a similar strategy was applied in the analysis of co-methylated CpG enrichment in transcription factor binding sites (TFBS)

## Constructing background set of EPIC Array CpGs for enrichment analyses

* `permutation.R` Script generates a background consisting of 1000 permuted sets of CpGs, each equal in length to the number of DCM sentinel CpG set (n=194). A sliding-window approach previously described in McAllan et al. 2023 Nat Commun [https://www.nature.com/articles/s41467-023-38439-z](https://www.nature.com/articles/s41467-023-38439-z) is implemented to select EPIC array CpGs of equivalent methylation levels and variablity to each sentinel CpG.
* `enrichment.sh` This Bash script performs an enrichment and depletion analysis on genomic features using BED files. It compares sentinel CpG overlap with genomic features against background CpG overlap with genomic features to determine whether sentinel CpGs overlaps significantly more (enrichment) or less (depletion) than expected based on background data. The script first compares the overlap count of the sentinel CpG set to the average overlap count of the 1,000 background sets to determine if an enrichment or depletion analysis should be performed. Next, depending on the test type, the script calculates 'exceeding_background_count': this is the number of background sets with overlap counts that are higher (enrichment analysis) or lower (depletion analysis) the sentinel CpG set. Significance can then be calculated (i.e. for enrichment analysis, if none of the 1000 background sets have overlap counts exceeding that of the sentinel CpG set, the sentinel CpG set is said to be enriched for that gene feature at p<0.001)


