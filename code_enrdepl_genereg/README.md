## General 
This repository contains scripts for performing enrichment analysis using eFORGE as well as the manual construction of a background CpG set of EPIC array CpGs using the sliding-window approach to match CpGs by methylation levels and variability.

## eFORGE analysis

To run the eFORGE enrichment/depletion analysis, set the working directory to the same directory as where the eFORGE software resides. Next, 
execute the .pl script as follows (example: analysing enrichment in Roadmap DHS hypersensitivity sites)
```
perl eforge.pl -f ./sentinels_194_ID.csv  --array 850k -data erc2-DHS -label erc2-DHS --noproxy 
```

* `eforge.pl` : main script for eFORGE enrichment/depletion analysis 
* `plot_eforge_enrdepl.R`: reads in enrichment and depletion results generated by running the eforge.pl script, calculates p-values for one-tailed permutation test, and generates a heatmap showing log2 fold enrichment calculated by comparing sentinel CpG overlap to the mean overlap of the 1000 background sets 

## Constructing background set of EPIC Array CpGs for enrichment analyses

* 'permutation.R' Script generates a background consisting of 1000 permuted sets of CpGs, each equal in length to the number of DCM sentinel CpG set (n=194). A sliding-window approach previously described in McAllan et al. 2023 Nat Commun [https://www.nature.com/articles/s41467-023-38439-z](https://www.nature.com/articles/s41467-023-38439-z) is implemented to select EPIC array CpGs of equivalent methylation levels and variablity to each sentinel CpG.


